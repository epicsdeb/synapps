From: Michael Davidsaver <mdavidsaver@bnl.gov>
Date: Sun, 12 Jun 2011 22:00:56 -0400
Subject: [PATCH] asyn: vxi11 depends

Correct dependencies so that parallel builds work
---
 asyn/asyn/Makefile |   28 ++++++++++++++++++----------
 1 files changed, 18 insertions(+), 10 deletions(-)

diff --git a/asyn/asyn/Makefile b/asyn/asyn/Makefile
index 26f5204..0831bd9 100644
--- a/asyn/asyn/Makefile
+++ b/asyn/asyn/Makefile
@@ -166,20 +166,28 @@ asyn_SRCS += boSRQonOff.c
 include $(TOP)/configure/RULES
 
 ifdef T_A
-ifeq ($(OS_CLASS),vxWorks)
-vxi11core_xdr.c: ../vxi11/rpc/vxi11core_xdr.c
-	cp ../vxi11/rpc/*.[ch] .
-else
-ifeq ($(OS_CLASS),RTEMS)
-vxi11core_xdr.c: ../vxi11/rpc/vxi11core_xdr.c
-	cp ../vxi11/rpc/*.[ch] .
+ifneq ($(findstring $(OS_CLASS),vxWorks RTEMS),)
+
+vxi11core.h vxi11core_xdr.c vxi11intr.h vxi11intr_xdr.c : \
+% : ../vxi11/rpc/%
+	cp $< $@
+
 else
+
 RPCGEN_FLAGS_solaris = -M
-vxi11core_xdr.c drvVxi11.c: ../vxi11/vxi11core.rpcl ../vxi11/vxi11intr.rpcl
+vxi11core.h vxi11core_xdr.c: ../vxi11/vxi11core.rpcl
 	cp ../vxi11/vxi11core.rpcl .
-	cp ../vxi11/vxi11intr.rpcl .
 	rpcgen $(RPCGEN_FLAGS_$(OS_CLASS)) vxi11core.rpcl
+
+vxi11intr.h vxi11intr_xdr.c: ../vxi11/vxi11intr.rpcl
+	cp ../vxi11/vxi11intr.rpcl .
 	rpcgen $(RPCGEN_FLAGS_$(OS_CLASS)) vxi11intr.rpcl
+
 endif
+
+vxi11core_xdr.c: vxi11core.h
+vxi11intr_xdr.c: vxi11intr.h
+
 endif
-endif
+
+$(ASYN)/vxi11/drvVxi11.c: vxi11intr.h
-- 
