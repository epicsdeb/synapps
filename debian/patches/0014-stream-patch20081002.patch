From: Michael Davidsaver <mdavidsaver@bnl.gov>
Date: Wed, 27 Jul 2011 09:55:38 -0400
Subject: [PATCH] stream: patch20081002

---
 stream/src/MantissaExponentConverter.cc |    4 ++--
 stream/src/RawFloatConverter.cc         |   13 +++++++++++++
 2 files changed, 15 insertions(+), 2 deletions(-)

diff --git a/stream/src/MantissaExponentConverter.cc b/stream/src/MantissaExponentConverter.cc
index 5955fb5..060efb6 100644
--- a/stream/src/MantissaExponentConverter.cc
+++ b/stream/src/MantissaExponentConverter.cc
@@ -60,7 +60,7 @@ scanDouble(const StreamFormat& fmt, const char* input, double& value)
     sscanf(input, "%d%d%n", &mantissa, &exponent, &length);
     if (fmt.flags & skip_flag) return length;
     if (length == -1) return -1;
-    value = (double)(mantissa) * pow(10, exponent);
+    value = (double)(mantissa) * pow(10.0, exponent);
     return length;
 }
 
@@ -75,7 +75,7 @@ printDouble(const StreamFormat& fmt, StreamBuffer& output, double value)
     int prec = fmt.prec;
     
     if (prec < 1) prec = 6;
-    buf.printf("%.*e", prec-1, fabs(value)/pow(10, prec-1));
+    buf.printf("%.*e", prec-1, fabs(value)/pow(10.0, prec-1));
     buf.remove(1,1);
     buf.remove(buf.find('e'),1);
     
diff --git a/stream/src/RawFloatConverter.cc b/stream/src/RawFloatConverter.cc
index 543ae9d..f643960 100644
--- a/stream/src/RawFloatConverter.cc
+++ b/stream/src/RawFloatConverter.cc
@@ -36,6 +36,19 @@
 #include <sys/param.h>
 #endif
 
+// Some architectures don't define __BYTE_ORDER but
+// define either _LITTLE_ENDIAN or _BIG_ENDIAN
+#ifndef __BYTE_ORDER
+#define __LITTLE_ENDIAN 1234
+#define __BIG_ENDIAN 4321
+#if defined(_BIG_ENDIAN) && !defined(_LITTLE_ENDIAN)
+#define __BYTE_ORDER __BIG_ENDIAN
+#endif
+#if !defined(_BIG_ENDIAN) && defined(_LITTLE_ENDIAN)
+#define __BYTE_ORDER __LITTLE_ENDIAN
+#endif
+#endif
+
 #ifndef __BYTE_ORDER
 #error define __BYTE_ORDER as __LITTLE_ENDIAN or __BIG_ENDIAN
 #endif
-- 
